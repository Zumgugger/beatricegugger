{% extends "admin/base.html" %}
{% block title %}Seiten - Admin{% endblock %}
{% block admin_content %}
<h1>Seiten</h1>
<form class="form-grid" method="POST" action="{{ url_for('admin.create_page') }}" enctype="multipart/form-data">
    <h2>Neue Seite anlegen</h2>
    <label>Titel*
        <input type="text" name="title" required>
    </label>
    <label>Slug*
        <input type="text" name="slug" placeholder="about-kontakt" required>
    </label>
    <label>Inhalt
        <textarea name="content" class="wysiwyg" rows="6"></textarea>
    </label>
    <label>Bild
        <input type="file" name="image" accept="image/*">
    </label>
    <button type="submit" class="btn btn-primary">Seite speichern</button>
</form>

<table>
    <thead>
        <tr>
            <th>Titel</th>
            <th>Slug</th>
            <th>Zuletzt aktualisiert</th>
            <th>Bearbeiten</th>
        </tr>
    </thead>
    <tbody>
        {% for page in pages %}
        <tr>
            <td>{{ page.title }}</td>
            <td>{{ page.slug }}</td>
            <td>{% if page.updated_at %}{{ page.updated_at.strftime('%d.%m.%Y %H:%M') }}{% else %}-{% endif %}</td>
            <td>
                <form method="POST" action="{{ url_for('admin.update_page', page_id=page.id) }}" enctype="multipart/form-data" class="form-inline">
                    <input type="text" name="title" value="{{ page.title }}" required>
                    <input type="text" name="slug" value="{{ page.slug }}" required>
                    <input type="file" name="image" accept="image/*">
                    <textarea name="content" class="wysiwyg" rows="4">{{ page.content }}</textarea>
                    <div class="inline-actions">
                        <button type="submit" class="btn btn-primary">Speichern</button>
                    </div>
                </form>
                <form method="POST" action="{{ url_for('admin.delete_page', page_id=page.id) }}" onsubmit="return confirm('Seite lÃ¶schen?');" class="form-inline">
                    <button type="submit" class="btn btn-danger">LÃ¶schen</button>
                </form>
            </td>
        </tr>
        {% else %}
        <tr><td colspan="4">Keine Seiten vorhanden.</td></tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
