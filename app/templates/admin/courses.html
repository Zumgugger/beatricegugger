{% extends "admin/base.html" %}
{% block title %}Kurse - Admin{% endblock %}
{% block admin_content %}
<h1>Kurse</h1>
<form class="form-grid" method="POST" action="{{ url_for('admin.create_course') }}" enctype="multipart/form-data">
    <h2>Neuen Kurs anlegen</h2>
    <label>Titel*
        <input type="text" name="title" required>
    </label>
    <label>Beschreibung
        <textarea name="description" class="wysiwyg" rows="6"></textarea>
    </label>
    <label>Datum & Zeit
        <input type="datetime-local" name="date">
    </label>
    <label>Ort
        <input type="text" name="location">
    </label>
    <label>Max. Teilnehmer
        <input type="number" name="max_participants" min="0">
    </label>
    <label>Bild
        <input type="file" name="image" accept="image/*">
    </label>
    <label class="checkbox">
        <input type="checkbox" name="is_active" value="1" checked>
        Aktiv
    </label>
    <button type="submit" class="btn btn-primary">Kurs speichern</button>
</form>

<table>
    <thead>
        <tr>
            <th>Titel</th>
            <th>Datum</th>
            <th>Ort</th>
            <th>Anmeldungen</th>
            <th>Status</th>
            <th>Aktionen</th>
        </tr>
    </thead>
    <tbody>
        {% for course in courses %}
        <tr>
            <td>{{ course.title }}</td>
            <td>{% if course.date %}{{ course.date.strftime('%d.%m.%Y %H:%M') }}{% else %}-{% endif %}</td>
            <td>{{ course.location or '-' }}</td>
            <td>{{ course.registration_count }}</td>
            <td>{{ 'Aktiv' if course.is_active else 'Inaktiv' }}</td>
            <td>
                <a class="btn" href="{{ url_for('admin.course_registrations', course_id=course.id) }}">Anmeldungen</a>
                <a class="btn" href="{{ url_for('admin.edit_course', course_id=course.id) }}">Bearbeiten</a>
                <form method="POST" action="{{ url_for('admin.delete_course', course_id=course.id) }}" style="display:inline" onsubmit="return confirm('Diesen Kurs löschen?');">
                    <button type="submit" class="btn btn-danger">Löschen</button>
                </form>
            </td>
        </tr>
        {% else %}
        <tr><td colspan="6">Keine Kurse vorhanden.</td></tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
